<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="/image/favicon.png" type="image/x-icon"/>
    <link rel="stylesheet" href="style.css">
    <script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
    <script src="navigation_bar.js"></script>
    <title>蜜罐后台监控系统-研究背景</title>
</head>
<body>
<div id='title'>“槐树花”蜜罐后台监控系统</div>
<div id='subtitle'>&nbsp;&nbsp;&nbsp;&nbsp;NESC, ZJU</div>
<div id='navigationbar'><ul>
    <li class='active'><a href='#'><span>系统简介</span></a><ul>
        <li><a href='index.html'><span>首页</span></a></li>
        <li><a href='background.html'><span>研究背景</span></a></li>
        <li><a href='structure.html'><span>系统结构</span></a></li>
        <li><a href='principle.html'><span>系统原理</span></a></li>
        <li><a href='result.html'><span>结果与分析</span></a></li>
    </ul></li>
    <li><a href='#'><span>用户</span></a><ul>
        <li><a href='login.jsp'><span>登录/注销</span></a></li>
        <li><a href='grant.jsp'><span>权限管理</span></a></li>
    </ul></li>
    <li><a href='#'><span>监控记录</span></a><ul>
        <li><a href='s7_events.jsp'><span>事件记录</span></a></li>
        <li><a href='s7_volume.jsp'><span>访问量</span></a></li>
        <li><a href='ids_captures.jsp'><span>端口访问</span></a></li>
        <li><a href='ids_statistics.jsp'><span>端口扫描记录</span></a></li>
        <li><a href='ids_analysis.jsp'><span>端口扫描分析</span></a></li>
    </ul></li>
    <li><a href='#'><span>连接到蜜罐</span></a><ul>
        <li><a href='honeypot_info.jsp'><span>读取状态信息</span></a></li>
        <li><a href='honeypot_data.jsp'><span>读取数据</span></a></li>
    </ul></li>
</ul></div>
<div id='content'>
    <p><h1>1&nbsp;概述</h1></p>
    <p><h2>1.1&nbsp;研究背景</h2></p>
    <p>工业控制系统（ICS）广泛用于国家的基础工业和涉及国计民生的关键基础设施。随着工业生产向自动化、数字化、网络化方向发展，工业控制系统已由原来相对封闭、稳定的环境变得更加开放、多变。网络安全风险带来的不再仅仅是信息泄露、信息系统无法使用等小问题，而可能会对社会稳定、经济发展造成不可估量的影响。</p>
    <p>PLC的应用极为广泛，是工业控制系统系统中主要的控制器之一。它具有实时性（最低响应时间）和高可靠性（能长期运行不出错），因此被用于一些安全要求高的关键系统中。考虑到系统可能很大，控制室与现场可能很远，实际使用的PLC系统通常被设计成联网工作，管理、维护、监控工作都是通过网络进行的。尽管生产商强烈建议用户只能将PLC连接至信任的网络，但仍有相当多的用户为了方便将它们连接到公共互联网，甚至关闭了内置安全机制。</p>
    <p>以SHODAN为首的物联网设备搜索引擎，使用大量爬虫，在整个公共网络范围内通过服务标签锁定物联网设备并进行索引。所以，使用这样的工具，攻击者要找到目标很容易。而在大多数情况下，通过网络完全控制一个PLC也并不困难。但是，让一个关键工业过程的PLC掌握在别人手里是十分危险的，这可能造成严重的环境破坏和财产损失，因此工控系统PLC的安全问题必须受到重视。</p>
    <p>蜜罐并不是专门为了工控安全诞生的，它是在一般的网络安全斗争中，防御方为了扭转不利地位而开发出的一种工具。在此之前，防御方使用的物理隔离、加密、补丁、非军事区（DMZ）、防火墙、访问控制表（ACL）等一系列手段都是被动防御手段，使防御方处于非常不利的地位：攻击方只要找到一个漏洞就能攻破系统，而防御方必须修补所有的漏洞；攻击方可以使用侦察工具了解目标信息，而防御方对造成麻烦的破坏者一无所知。蜜罐技术很好地解决了上述问题，它使用“防御性欺骗”的方法，伪造虚假系统，诱使恶意者展开攻击，既保护了真实系统，又能够通过分析数据了解攻击方所使用的工具和方法，明确所面对的安全威胁。 “蜜罐项目组”（The Honeynet Project）的创始人Lance Spitzner这样定义蜜罐：蜜罐是一种安全资源，其价值在于被扫描、攻击和攻陷。</p>
    <p>PLC蜜罐是将传统蜜罐引进工控安全领域后诞生的新型蜜罐。虽然它所使用的策略和传统蜜罐大同小异，但它所仿真的内容大大拓宽了。它不仅仿真软件，还仿真硬件、通信、工业过程等物理实体。</p>
    <p><h2>1.2&nbsp;研究现状</h2></p>
    <p>PLC蜜罐的目标，就是要使攻击者保持兴趣，像攻击一个真正的PLC一样攻击蜜罐。</p>
    <p>根据模仿PLC的逼真程度，蜜罐分为三个等级。低交互的蜜罐只仿真基本的网络服务（或基本网络服务的一部分），这种蜜罐维护方便但容易被识破；高交互的蜜罐仿真多种复杂的网络服务，可以更长久地吸引攻击者的注意力，但实现起来也更加困难；混合蜜罐试图将两者结合起来，得到所有的优点，它在不同的交互水平上仿真不同的服务。</p>
    <p>也有研究者重视PLC中运行的程序，根据对抗者与程序的交互水平将PLC蜜罐分为三个等级。低交互的蜜罐只能让对抗者与主机通信，而不能访问程序，这种蜜罐一般没有什么吸引力；中交互的蜜罐可以使对抗者与主机和程序交互；高交互的蜜罐甚至可以让对抗者读写程序，留有更大空间让对抗者暴露自己的方法和意图。对蜜罐的分类方法的差别，说明不同研究团体的价值取向不同。</p>
    <p>思科关键基础设施确保小组（CIAG）于2004年启动了Scada蜜网计划，它依赖于能在网络上创建虚拟主机运行服务的Honeyd，并且使用Python脚本实现仿真PLC。[9]但该计划次年就中止了。留下的主要贡献包括模拟FTP、Modbus&nbsp;TCP和Telnet协议的脚本，和一个网络服务器组件。它的Modbus同步仿真脚本与交互性全功能Modbus还有区别，并且没有云端部署能力。</p>
    <p>SCADA蜜网由数字纽带（一个控制系统安全咨询和研究公司）维护，可以在其网站上访问。它由两个虚拟机组成，其中一个仿真流行的PLC型号，并允许对外服务，如FTP、Telnet、Modbus TCP、HTTP、SNMP。另一个是扩展了数字纽带的Quickdraw&nbsp;IDS签名的、蜜罐项目组开发的第三代蜜墙，它使用专门工具集中监控所有的网络活动和统计数据。它可以伪造服务标签信息和操作系统指纹，使信息收集工具认为它是真正的PLC。但是，仿真的服务提供很少的交互，不能吸引攻击者足够长时间。另外，它不适合于大规模部署和运行，功能和协议扩展都很困难。</p>
    <p>“蜜罐项目组”开发的“Conpot工程”于2013年发布，目前该项目仍处于活跃开发中。它是一个工业控制系统蜜罐，目标是收集有关针对工业控制系统的对抗行为的“动机和方法”的情报。蜜罐使用Python脚本实现了两个主要的工控协议：Modbus和SNMP，同时它也具备HTTP服务和日志系统。蜜罐默认仿真西门子S7-200 PLC，但要配置成其他型号也比较简单。作为目前较新的蜜罐系统实现，Conpot工程的基础概念是好的，但也存在一些缺憾。它需要繁琐的定制和配置工作后才能运行，而且它提供的交互仍然很少，攻击者可能还没有暴露自己的动机和方法就走了。</p>
    <p>CryPLH仿真S7-300。作者把CryPLH描述成一个高交互的蜜罐，声称的目标是提高原有产品的交互性，配置能力和不可分辨性。CryPLH静态复刻了真实PLC的网络接口，并且看起来也一模一样。然而，CryPLH仿真了开启最高安全保护级别的PLC，拒绝任何密码认证。因此，CryPLH阻止攻击者的进一步探索。由于攻击者既不能查看又不能修改PLC运行的程序，他所能做的事情和暴露的东西仍然很少。</p>
    <p>在有上述蜜罐的基础上，构建蜜网的方法也是研究的一大要点。系统结构的设计，连接的配置，管理工作的实施都要使用相当多的网络优化技术。一般蜜网中的蜜罐程序运行在商业化的云平台上，但也有研究者在一台计算机上使用IMUNES等工具虚拟出复杂的蜜罐网络。</p>
    <p>PLC蜜罐的实现是软件工程、计算机网络开发、蜜罐技术、工业自动化控制技术的结合，可以从这些领域的发展中得到理论指导。软件工程提供了模块化的程序设计思路，以及将操作整合成命令集的封装做法；分布式网络系统指导了蜜网中PLC蜜罐节点的部署与相互关联问题；广泛且有更多对抗经验的蜜罐技术可以向PLC蜜罐提供各类现成的网络安全工具，供构建及测试PLC蜜罐时使用。这同时也提醒网络安全的技术人员应多关注各类工具的发展情况，尽量使用已有的工具解决问题，避免自己开发工具，因为已有的工具更加成熟，且使用起来更加节省时间，提高了开发效率。</p>
    <p><h2>1.3&nbsp;研究计划</h2></p>
    <p><strong>论文标题：</strong>基于Snap7的PLC蜜罐设计</p>
    <p><strong>题目来源：</strong>结合科研课题</p>
    <p><strong>课题简介：</strong>工业控制系统广泛应用于电厂，核电站，水/废水，能源部门等行业中，起到实时监测和控制各种设备，资源和过程的作用，与人们的生活息息相关。近年来在工控系统中出现来越来越多的安全事件，如2010年的震网（Stuxnet）事件，2014年的乌克兰电网事件等，引起了各界的广泛关注，提出了许多针对工业控制系统的防护手段。PLC蜜罐是运行于主机中的虚拟设备，能够模拟真实PLC设备的基本功能，用于迷惑攻击者，并记录攻击者的操作，为进一步研究防御作准备。</p>
    <p><strong>研究内容：</strong>以西门子S7-300&nbsp;PLC为原型，基于Snap7开源工具设计PLC蜜罐；实现S7comm，Modbus/TCP协议中的部分功能，包括基本控制与数据读写；开发可视化界面，并能记录攻击者的操作。</p>
    <p>经过文献调研和对研究现状的分析，我确定了本蜜罐系统需要实现的功能。包括三个基础功能——S7comm协议，Step7读写程序，记录可疑行为，和六个扩展功能——被控对象仿真，可视化界面，Modbus协议，多PLC系统仿真，抹消操作系统指纹，端口扫描检测。其中，S7comm协议和记录可疑行为两个功能使本系统具有了蜜罐的基本基本特征——交互和监控，Step7读写程序是项目成果检验的主要手段。虽然上线运行也可以检验一个蜜罐的逼真程度，但这种方法具有不确定性，所以不作为主要的检验手段。</p>
    <p>作为毕业设计，本项目的目标不仅是包括一个可以实际使用的蜜罐系统，还包括网络安全知识、攻防实践、西门子PLC结构、Modbus协议规范、编程及其他相关技术的学习。</p>
    <center>
    <table border='1'>
    <tr><th>时间区间</th><th>工作内容</th></tr>
    <tr><td>2018-11-19&nbsp;至&nbsp;<br>2018-12-16</td><td>学习相关工作的文献至少10篇，其中外文文献至少5篇，明确课题的范围；<br>综合指导老师、做过类似项目的研究生的意见，以及文献中的叙述，确定各阶段研究的基本框架与技术路线。</td></tr>
    <tr><td>2018-12-17&nbsp;至&nbsp;<br>2019-01-13</td><td>分析已有的研究成果和当前发展方向，形成文献综述；<br>撰写开题报告，详细阐述本课题的技术路线，分析系统搭建、调试、展示的关键点、创新点和难点，合理安排研究计划，列举预期成果；<br>根据要求完成外文文献翻译任务，并参加学院的开题答辩。</td></tr>
    <tr><td>2019-02-25&nbsp;至&nbsp;<br>2019-03-24</td><td>准备step7软件、搭建相关平台、学习snap7开源库；<br>实现S7comm协议，完成单个PLC的蜜罐系统。</td></tr>
    <tr><td>2019-03-25&nbsp;至&nbsp;<br>2019-04-21</td><td>实现Modbus协议；<br>实现多PLC系统和被控对象的仿真；<br>开发可视化界面，降低系统使用难度；<br>为程序写注释和使用说明书。</td></tr>
    <tr><td>2019-04-22&nbsp;至&nbsp;<br>2019-05-19</td><td>整理研究成果和材料，包括程序工程、说明文档、系统模型、测试样例、程序可视化界面的截图或录像等；<br>根据学院要求的格式撰写规范的毕业论文，并准备答辩材料。</td></tr>
    </table>
    <p>表1&nbsp;进度安排</p>
    </center>
</div>
</body>
</html>
